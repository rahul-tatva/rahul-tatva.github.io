if("undefined"==typeof trendii)trendii={};else if("object"!=typeof trendii)throw new Error("trendii already exists and is not an object.");trendii.DESKTOP_IMAGE_GROUP_PARENT_DIV_CLASS=".mol-img-group",trendii.MOBILE_IMAGE_GROUP_PARENT_TAG="figure",trendii.DESKTOP_IMAGE_CAPTION_CLASS="imageCaption",trendii.MOBILE_IMAGE_CAPTION_TAG="figcaption",trendii.SLIDER_CLASS_TO_REPLACE_WITH="trendiiSliderUniqueString",trendii.adsWindow=window.top,trendii.adsDOM=trendii.adsWindow.document,trendii.feedProducts=[],trendii.intersectionObserver,trendii.slidersAppendedArray=[],trendii.sliderCount=0,trendii.nativeAdSimpleTemplateHTMLString=null,trendii.nativeAdSliderTemplateHTMLString=null,trendii.publisherURL="https://rahul-tatva.github.io",trendii.init=function(){trendii.console.log("SDK init method called"),trendii.globals.PUBLISHER_ID=2,trendii.loadScriptAndCssToHead(),trendii.loadStyleSheetIntoHead(`${trendii.globals.CDN}/styles/daily-mail/trendii-sdk-daily-mail-slider.css`),trendii.loadStyleSheetIntoHead(`${trendii.globals.CDN}/styles/daily-mail/trendii-sdk-daily-mail-all-product.css`),"complete"===trendii.adsDOM.readyState||"interactive"===trendii.adsDOM.readyState?(trendii.console.log(trendii.adsDOM.readyState),trendii.startAdGenerationProcess()):(trendii.console.log("DOM in progress"),trendii.adsDOM.addEventListener("DOMContentLoaded",()=>{trendii.console.log(trendii.adsDOM.readyState),trendii.startAdGenerationProcess()}))},trendii.env="production",trendii.globals={PUBLISHER_NAME:"",PUBLISHER_ID:0,MOBILE_WIDTH:480,CDN:"https://cdn.trendii.com/native-ads-sdk",API_GET_NATIVE_AD_PRODUCT:"https://beeswaxcreatives.trendii.com/img-creatives",AD_PRODUCTS_CONTAINER:"trendii-sdk-ad-products-container",RETAILER_LOGO_ID:"retailer-logo",HTML_TEMPLATE_AD_WRAPPER_ID:"trendii-native-ad-wrapper",HTML_TEMPLATE_SLIDER_CONTAINER_ID:"trendii-sdk-ad-products-container",HTML_TEMPLATE_SIMPLE_CONTAINER_ID:"trendii-products-container-728X90"},trendii.globals.API_GET_NATIVE_AD_SLIDER_TEMPLATE=`${trendii.globals.CDN}/templates/products-slider-dynamic.html`,trendii.globals.API_GET_NATIVE_AD_SIMPLE_TEMPLATE=`${trendii.globals.CDN}/templates/products-728X90-all-product-dynamic.html`,trendii.console={log:function(){if("test"===trendii.env){let args=Array.prototype.slice.call(arguments);args.unshift("[Trendii.SDK] ==>"),console.log.apply(console,args)}},error:function(){let args=Array.prototype.slice.call(arguments);args.unshift("[Trendii.SDK] ==>"),console.error.apply(console,args)}},trendii.getRetailerLogoPath=function(fileName){return`${trendii.globals.CDN}/images/retailers-logo/${fileName}`},trendii.createHtmlElement=function(element,classes,innerHTML,style,href,target){const htmlElement=trendii.adsDOM.createElement(element);return htmlElement.classList.add(classes),innerHTML&&(htmlElement.innerHTML=innerHTML),style&&(htmlElement.style=style),href&&(htmlElement.href=href),target&&(htmlElement.target=target),htmlElement},trendii.setPublisherName=function(name){trendii.globals.PUBLISHER_NAME=name},trendii.loadScriptIntoHead=function(url){trendii.adsDOM.head.appendChild(trendii.adsDOM.createElement("script")).src=url},trendii.loadStyleSheetIntoHead=function(url){let styles=trendii.adsDOM.createElement("link");styles.type="text/css",styles.rel="stylesheet",styles.href=url,trendii.adsDOM.head.appendChild(styles)},trendii.loadScriptAndCssToHead=function(){"test"===trendii.env?(trendii.loadScriptIntoHead(`${trendii.globals.CDN}/scripts/common/intersection-observer.js`),trendii.loadScriptIntoHead(`${trendii.globals.CDN}/scripts/common/splide.js`)):(trendii.loadScriptIntoHead(`${trendii.globals.CDN}/scripts/common/intersection-observer.min.js`),trendii.loadScriptIntoHead(`${trendii.globals.CDN}/scripts/common/splide.min.js`)),trendii.loadStyleSheetIntoHead(`${trendii.globals.CDN}/styles/common/splide-core.min.css`)},trendii.startAdGenerationProcess=function(){try{Promise.all([fetch(trendii.globals.API_GET_NATIVE_AD_SLIDER_TEMPLATE).then(response=>response.text()),fetch(trendii.globals.API_GET_NATIVE_AD_SIMPLE_TEMPLATE).then(response=>response.text())]).then(options=>{trendii.nativeAdSliderTemplateHTMLString=options[0],trendii.nativeAdSimpleTemplateHTMLString=options[1];options={rootMargin:"0px",threshold:.1};trendii.adsWindow.TrendiiIntersectionObserver?trendii.intersectionObserver=new trendii.adsWindow.TrendiiIntersectionObserver(trendii.handleIntersectionEntries,options):trendii.intersectionObserver=new IntersectionObserver(trendii.handleIntersectionEntries,options);let allParentEls;allParentEls=trendii.adsWindow.innerWidth<=trendii.globals.MOBILE_WIDTH?Array.from(trendii.adsDOM.querySelectorAll(trendii.MOBILE_IMAGE_GROUP_PARENT_TAG)):Array.from(trendii.adsDOM.querySelectorAll(trendii.DESKTOP_IMAGE_GROUP_PARENT_DIV_CLASS)),allParentEls.forEach(parentEl=>{trendii.intersectionObserver.observe(parentEl)})})}catch(err){trendii.console.error(err)}},trendii.handleIntersectionEntries=function(entries,observer){try{entries.forEach(entry=>{trendii.handleIntersectionEntry(entry,observer)})}catch(err){trendii.console.error(err)}},trendii.handleIntersectionEntry=function(entry,observer){try{if(entry.isIntersecting){const visibleParentEl=entry.target;observer.unobserve(entry.target),trendii.console.log("observer unregistered for ",visibleParentEl);const imageElsInsideSameParent=Array.from(visibleParentEl.getElementsByTagName("img"));var imagesPresentInSameParent=imageElsInsideSameParent.map(img=>img.getAttribute("data-src")?img.getAttribute("data-src"):img.getAttribute("src")).filter(x=>x),requestBody={webpageUrl:trendii.adsWindow.location.href,imageUrls:imagesPresentInSameParent,publisherId:trendii.globals.PUBLISHER_ID};const headers=new Headers;headers.append("Content-Type","application/json");var raw=JSON.stringify(requestBody),requestOptions={method:"POST",headers:headers,body:raw};fetch(trendii.globals.API_GET_NATIVE_AD_PRODUCT,requestOptions).then(response=>response.json()).then(sliderIdSelector=>{if(""!==sliderIdSelector){if(sliderIdSelector.success&&!0===sliderIdSelector.success){const adProductsData=sliderIdSelector;let foundImageData=null,foundIndex,currentImageEle,imageSrcToShowAd,imageDataSrcToShowAd;var imageElsInsideSameParentLength=imageElsInsideSameParent.length;for(let i=0;i<imageElsInsideSameParentLength;i++)if(currentImageEle=imageElsInsideSameParent[i],imageSrcToShowAd=currentImageEle.src,imageDataSrcToShowAd=currentImageEle.getAttribute("data-src"),foundIndex=adProductsData.payload.findIndex(imageData=>imageData.imageUrl===imageSrcToShowAd||imageDataSrcToShowAd),foundImageData=adProductsData.payload[foundIndex],foundImageData.products&&0<foundImageData.products.length){currentImageEle;break}if(foundImageData.products&&0<foundImageData.products.length&&(trendii.generatedAdForSingleImage(foundImageData,trendii.sliderCount),trendii.sliderCount++,foundImageData.generatedAdHTML)){if(trendii.adsWindow.innerWidth<=trendii.globals.MOBILE_WIDTH){const titleOfImageGroup=visibleParentEl.getElementsByTagName(trendii.MOBILE_IMAGE_CAPTION_TAG)[0];titleOfImageGroup?titleOfImageGroup.after(foundImageData.generatedAdHTML):visibleParentEl.appendChild(foundImageData.generatedAdHTML)}else visibleParentEl.getElementsByClassName(trendii.DESKTOP_IMAGE_CAPTION_CLASS)[0].after(foundImageData.generatedAdHTML),foundImageData.isAdGenerated=!0,trendii.console.log("ad rendered for ",visibleParentEl);var identifier=foundImageData.sliderId,sliderIdSelector=`#${identifier}`;if(foundImageData.isSliderTemplate&&(trendii.slidersAppendedArray.push(foundImageData.sliderId),trendii.console.log(trendii.adsWindow.Splide),trendii.adsWindow.Splide)){const testSlider=new trendii.adsWindow.Splide(sliderIdSelector,{type:"loop",pagination:!1,gap:10,autoWidth:!0,autoHeight:!0}).mount(),adProductsSliderContainer=trendii.adsDOM.getElementById(identifier);adProductsSliderContainer.style.display="block";const adWrapper=foundImageData.generatedAdHTML;adWrapper.setAttribute("data-slider-appended","true"),adWrapper.style.display="block",trendii.console.log("slider appended"),testSlider.on("mounted",function(){console.log("mounted")})}}}}else trendii.console.log("empty feed response")}).catch(err=>{trendii.console.error(err),"function"==typeof onErrorCallback&&onErrorCallback(error)})}}catch(err){trendii.console.error(err)}},trendii.generatedAdForSingleImage=function(imageData,foundIndex){imageData.generatedAdHTML=trendii.createAdsForAllProductsInAdvance(imageData,foundIndex)},trendii.createAdTemplatesForAllProducts=function(){try{trendii.feedProducts.payload.map((imageData,index)=>{imageData.products&&0<imageData.products.length&&(imageData.generatedAdHTML=trendii.createAdsForAllProductsInAdvance(imageData,index))})}catch(err){trendii.console.error(err)}},trendii.createAdsForAllProductsInAdvance=function(imageData,index){try{imageData.imageUrl,imageData.advertiserName;let products=imageData.products;trendii.adsWindow.innerWidth>trendii.globals.MOBILE_WIDTH&&(products=imageData.products.slice(0,4));const advertiserName=imageData.advertiserName;var identifier=`splide${index}`;switch(imageData.sliderId=identifier,products.length){case 1:case 2:case 3:case 4:{imageData.isSliderTemplate=!1;const domParser=new DOMParser,simpleTemplateDOM=domParser.parseFromString(trendii.nativeAdSimpleTemplateHTMLString,"text/html");var logoUrl=trendii.getRetailerLogoPath(`${advertiserName.toLowerCase()}.png`);const retailerLogoEl=simpleTemplateDOM.getElementById(trendii.globals.RETAILER_LOGO_ID);retailerLogoEl.title=advertiserName,retailerLogoEl.src=logoUrl;const productsContainerEl=simpleTemplateDOM.getElementById(trendii.globals.HTML_TEMPLATE_SIMPLE_CONTAINER_ID);return productsContainerEl.innerHTML="",trendii.initializeRenderingProductsBasedOnCount(products,productsContainerEl),simpleTemplateDOM.getElementById(trendii.globals.HTML_TEMPLATE_AD_WRAPPER_ID)}default:{imageData.isSliderTemplate=!0;var newDOM=trendii.nativeAdSliderTemplateHTMLString.replaceAll(trendii.SLIDER_CLASS_TO_REPLACE_WITH,identifier);const domParser=new DOMParser,templatesDOM=domParser.parseFromString(newDOM,"text/html"),logoUrl=trendii.getRetailerLogoPath(`${advertiserName.toLowerCase()}.png`),retailerLogoEl=templatesDOM.getElementById(trendii.globals.RETAILER_LOGO_ID);retailerLogoEl.title=advertiserName,retailerLogoEl.src=logoUrl;const adProductsSliderContainer=templatesDOM.getElementById(identifier);adProductsSliderContainer.style.display="none";let productsContainerEl=templatesDOM.getElementById(trendii.globals.HTML_TEMPLATE_SLIDER_CONTAINER_ID);productsContainerEl.innerHTML="",products.forEach(product=>trendii.createSliderItemProduct(product,productsContainerEl));const resultantAdWrapper=templatesDOM.getElementById(trendii.globals.HTML_TEMPLATE_AD_WRAPPER_ID);return resultantAdWrapper.style.display="none",resultantAdWrapper}}}catch(err){return trendii.console.error(err),null}},trendii.getAllParentImageGroupClassMobile=function(){try{let allParentElements;allParentElements=trendii.adsWindow.innerWidth<=trendii.globals.MOBILE_WIDTH?trendii.adsDOM.querySelectorAll(trendii.MOBILE_IMAGE_GROUP_PARENT_TAG):trendii.adsDOM.querySelectorAll(trendii.DESKTOP_IMAGE_GROUP_PARENT_DIV_CLASS);const parentImageGroupElements=Array.from(allParentElements);trendii.console.log(parentImageGroupElements);let foundImageData=null,foundImageElement;parentImageGroupElements.forEach((parentEl,index)=>{trendii.console.log(parentEl.getElementsByTagName("img"));var allImagesPresentInTheSameGroup=Array.from(parentEl.getElementsByTagName("img"));let currentImageEle,imageSrcToShowAd,imageDataSrcToShowAd;for(let i=0;i<allImagesPresentInTheSameGroup.length;i++)if(currentImageEle=allImagesPresentInTheSameGroup[i],imageSrcToShowAd=currentImageEle.src,imageDataSrcToShowAd=currentImageEle.getAttribute("data-src"),foundImageData=trendii.feedProducts.payload.find(imageData=>imageData.imageUrl===imageSrcToShowAd||imageDataSrcToShowAd),foundImageData.generatedAdHTML){foundImageElement=currentImageEle;break}if(foundImageData.generatedAdHTML){const adContainer=trendii.adsDOM.createElement("div");adContainer.classList.add("adContainer"),adContainer.style.background="yellow",adContainer.style.maxHeight="300px";const adContainerMobile=trendii.adsDOM.createElement("div");if(adContainerMobile.classList.add("ads-inside-the-images"),trendii.adsWindow.innerWidth<=trendii.globals.MOBILE_WIDTH){const titleOfImageGroup=parentEl.getElementsByTagName(trendii.MOBILE_IMAGE_CAPTION_TAG)[0];titleOfImageGroup?titleOfImageGroup.after(foundImageData.generatedAdHTML):parentEl.appendChild(foundImageData.generatedAdHTML)}else parentEl.getElementsByClassName(trendii.DESKTOP_IMAGE_CAPTION_CLASS)[0].after(foundImageData.generatedAdHTML)}})}catch(err){trendii.console.error(err)}},trendii.createSliderItemProduct=function(product,productsContainer){try{const sliderItem=trendii.createHtmlElement("LI","splide__slide");productsContainer.appendChild(sliderItem);const productItemRedirectContainer=trendii.createHtmlElement("A","product-redirection-link",null,"text-decoration: none;",product.url,"_blank");sliderItem.appendChild(productItemRedirectContainer);const productItemContainer=trendii.createHtmlElement("DIV","product-item-container");productItemContainer.addEventListener("click",function(){adsWindow.open(product.url,"_blank")}),productItemRedirectContainer.appendChild(productItemContainer);const productItem=trendii.createHtmlElement("DIV","product-item");productItem.style.backgroundImage=`url(${product.image})`,productItemContainer.appendChild(productItem),product.sale&&productItem.appendChild(trendii.createHtmlElement("SPAN","onsale","ON SALE"));const productDetailsWrapper=trendii.createHtmlElement("DIV","product-details-wrapper");productDetailsWrapper.addEventListener("click",function(){adsWindow.open(product.url,"_blank")}),productItem.appendChild(productDetailsWrapper);const productDetailsWrapperMobile=trendii.createHtmlElement("DIV","product-details-wrapper-mobile");productItemContainer.appendChild(productDetailsWrapperMobile),productDetailsWrapper.appendChild(trendii.createHtmlElement("P","product-name",product.name)),productDetailsWrapperMobile.appendChild(trendii.createHtmlElement("P","product-name",product.name)),productDetailsWrapper.appendChild(trendii.createHtmlElement("EM","product-price",product.currency+product.price)),productDetailsWrapperMobile.appendChild(trendii.createHtmlElement("EM","product-price",product.currency+product.price))}catch(err){console.logError(err)}},trendii.createProductItemHtml=function(product,row,cssClass,which){try{const col=trendii.createHtmlElement("DIV",cssClass);row.appendChild(col);const productItemRedirectContainer=trendii.createHtmlElement("A","product-redirection-link",null,"text-decoration: none;",product.url,"_blank");col.appendChild(productItemRedirectContainer);const productItemContainer=trendii.createHtmlElement("DIV","product-item-container");productItemContainer.addEventListener("click",function(){adsWindow.open(product.url,"_blank")}),productItemRedirectContainer.appendChild(productItemContainer);const productItem=trendii.adsDOM.createElement("DIV");productItem.classList.add("product-item"),productItemContainer.appendChild(productItem);const productItemImage=trendii.createHtmlElement("DIV","product-item-image");productItemImage.style.backgroundImage=`url(${product.image})`,productItem.appendChild(productItemImage),product.sale&&productItemImage.appendChild(trendii.createHtmlElement("SPAN","onsale","ON SALE"));const productDetailsWrapper=trendii.createHtmlElement("DIV","product-details-wrapper");if((3<which?productItem:productItemContainer).appendChild(productDetailsWrapper),productDetailsWrapper.appendChild(trendii.createHtmlElement("P","product-name",product.name)),productDetailsWrapper.appendChild(trendii.createHtmlElement("EM","product-price",product.currency+product.price)),2<which){const productDetailsWrapperMobile=trendii.createHtmlElement("DIV","product-details-wrapper-mobile");productItemContainer.appendChild(productDetailsWrapperMobile),productDetailsWrapperMobile.appendChild(trendii.createHtmlElement("P","product-name",product.name)),productDetailsWrapperMobile.appendChild(trendii.createHtmlElement("EM","product-price",product.currency+product.price))}}catch(err){trendii.console.error(err)}},trendii.initializeRenderingProductsBasedOnCount=function(adRenderingProducts,productsContainer){switch(adRenderingProducts.length){case 1:{var product=adRenderingProducts[0];const oneProductWrapper=trendii.createHtmlElement("DIV","one-product-wrapper");productsContainer.appendChild(oneProductWrapper);var row=trendii.createHtmlElement("DIV","row");oneProductWrapper.appendChild(row),trendii.createProductItemHtml(product,row,"col-12",adRenderingProducts.length);break}case 2:{const twoProductWrapper=trendii.adsDOM.createElement("DIV");twoProductWrapper.classList.add("two-product-wrapper"),productsContainer.appendChild(twoProductWrapper);const row=trendii.adsDOM.createElement("DIV");row.classList.add("row"),twoProductWrapper.appendChild(row);for(let i=0;i<=1;i++)trendii.createProductItemHtml(adRenderingProducts[i],row,"col-6",adRenderingProducts.length);break}case 3:{const threeProductWrapper=trendii.adsDOM.createElement("DIV");threeProductWrapper.classList.add("three-product-wrapper"),productsContainer.appendChild(threeProductWrapper);const row=trendii.adsDOM.createElement("DIV");row.classList.add("row"),row.classList.add("row-cols-3"),threeProductWrapper.appendChild(row);for(let i=0;i<=2;i++)trendii.createProductItemHtml(adRenderingProducts[i],row,"col",adRenderingProducts.length);break}case 4:{const fourProductWrapper=trendii.adsDOM.createElement("DIV");fourProductWrapper.classList.add("four-product-wrapper"),productsContainer.appendChild(fourProductWrapper);const row=trendii.adsDOM.createElement("DIV");row.classList.add("row"),row.classList.add("row-cols-4"),fourProductWrapper.appendChild(row);for(let i=0;i<=3;i++)trendii.createProductItemHtml(adRenderingProducts[i],row,"col",adRenderingProducts.length);break}}},window.location.origin!==trendii.publisherURL&&"test"!==trendii.env||trendii.init();